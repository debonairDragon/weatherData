import edu.duke.*;
import org.apache.commons.csv.*;
import java.io.*;
/**
 * Write a description of class coldestDay here.
 *
 * @author (your name)
 * @version (a version number or a date)
 */
public class coldestDay
{
public CSVRecord coldestHourInFile(CSVParser parser) {
    CSVRecord smallestSoFar = null;
    for (CSVRecord currentRow : parser) {
      if (smallestSoFar == null) {
          
          smallestSoFar = currentRow;
    }
    else{
        double currentTemp = Double.parseDouble(currentRow.get("TemperatureF"));
        double smallestTemp = Double.parseDouble(smallestSoFar.get("TemperatureF"));
        if (currentTemp == -9999) {
            continue;
    }
    if (currentTemp < smallestTemp) {
      smallestSoFar = currentRow;  
    }
    
};
}
return smallestSoFar;
}

public void testColdestHourInFile() {
  FileResource fileEvaluated = new FileResource();
  CSVParser parser = fileEvaluated.getCSVParser();
  CSVRecord smallest = coldestHourInFile(parser);
  System.out.println("The coldest temperature is " + smallest);
};

public CSVRecord hottestHourInFile(CSVParser parser) {
 CSVRecord largestSoFar = null;
 for (CSVRecord currentRow : parser) {
     if (largestSoFar == null) {
         largestSoFar = currentRow;
}
else {
    double currentTemp = Double.parseDouble(currentRow.get("TemperatureF"));
    double largestTemp = Double.parseDouble(largestSoFar.get("TemperatureF"));
    if (currentTemp == -9999) {
        continue;
}
if (currentTemp > largestTemp){
 largestSoFar = currentRow;   
}
};
}
return largestSoFar;
}

public CSVRecord coldestInManyDays() {
 CSVRecord smallestSoFar = null;
 DirectoryResource dr = new DirectoryResource();
 String file = "";
 for (File f : dr.selectedFiles()){
     FileResource fr = new FileResource(f);
     CSVRecord currentRow = coldestHourInFile(fr.getCSVParser());
     if (smallestSoFar == null) {
         smallestSoFar = currentRow;
         file = f.getAbsolutePath();
        } else 
     if (smallestSoFar.equals("-9999")) {
         continue;
    }
    {
        double currentTemp = Double.parseDouble(currentRow.get("TemperatureF"));
        double smallestTemp = Double.parseDouble(smallestSoFar.get("TemperatureF"));
        if (currentTemp < smallestTemp) {
            smallestSoFar = currentRow;
            file = f.getAbsolutePath();
        }
    
}
}
return smallestSoFar;
}
public void testColdestInManyDays(){
CSVRecord coldestManyDays = coldestInManyDays();
System.out.println("The smallest temperature between all days was " + coldestManyDays);
}
};
